{% extends "base.html" %}

{% block title %}Chat - Yuzu Companion{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
{% endblock %}

{% block content %}
<div class="chat-wrapper">
    <header class="chat-header">
        <div>
            <h2>{{ profile.partner_name }}</h2>
            <p id="sessionName">Chat Session</p>
        </div>
        <div class="affection-display">
            <small>Affection: {{ profile.affection }}%</small>
        </div>
    </header>

    <div class="chat-container" id="chatContainer">
        <!-- Messages will be dynamically added here -->
    </div>

    <div id="typingIndicator" class="typing-indicator hidden">
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="input-area">
        <textarea id="messageInput" placeholder="Type your message... (Enter for newline, Ctrl+Enter to send)" rows="1"></textarea>
        <button id="sendButton" type="button">Send</button>
    </div>

    <button id="scrollToBottom" class="scroll-to-bottom hidden" type="button" aria-label="Scroll to bottom">
        â†“
    </button>
</div>
{% endblock %}

{% block extra_js %}
<!-- Marked.js for markdown rendering -->
<script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
<!-- Highlight.js for code syntax highlighting -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<!-- Renderer -->
<script src="{{ url_for('static', filename='js/renderer.js') }}"></script>
<!-- Chat logic -->
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}
