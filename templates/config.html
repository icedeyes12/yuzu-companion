{% extends "base.html" %}

{% block title %}Configuration - Yuzu Companion{% endblock %}

{% block content %}
<div class="container">
    <h1>Configuration</h1>

    <div class="card">
        <h2>Profile Settings</h2>
        <form id="profileForm">
            <div class="form-group">
                <label for="display-name">Your Display Name:</label>
                <input type="text" id="display-name" value="{{ profile.display_name }}">
            </div>

            <div class="form-group">
                <label for="partner-name">Partner Name:</label>
                <input type="text" id="partner-name" value="{{ profile.partner_name }}">
            </div>

            <div class="form-group">
                <label for="affection-level">Affection Level: <span id="affection-value">{{ profile.affection }}</span></label>
                <input type="range" id="affection-level" min="0" max="100" value="{{ profile.affection }}">
            </div>

            <button type="button" id="save-profile" class="btn">Save Profile Settings</button>
        </form>
    </div>

    <div class="card">
        <h2>AI Provider Settings</h2>
        <p>Configure your AI provider and model settings here.</p>
        <p><em>Provider management coming soon...</em></p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const affectionSlider = document.getElementById('affection-level');
    const affectionValue = document.getElementById('affection-value');
    const saveButton = document.getElementById('save-profile');

    if (affectionSlider && affectionValue) {
        affectionSlider.addEventListener('input', (e) => {
            affectionValue.textContent = e.target.value;
        });
    }

    if (saveButton) {
        saveButton.addEventListener('click', async () => {
            const data = {
                display_name: document.getElementById('display-name').value,
                partner_name: document.getElementById('partner-name').value,
                affection: parseInt(document.getElementById('affection-level').value)
            };

            try {
                await apiCall('/api/update_profile', {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
                showNotification('Profile saved successfully', 'success');
            } catch (error) {
                console.error('Failed to save profile:', error);
                showNotification('Failed to save profile', 'error');
            }
        });
    }
});
</script>
{% endblock %}
